<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Slickr: A Flickr API implementation.</title>
    <style type="text/css">
        img {
            margin: 15px;
            border: thin solid rgba(48, 48, 48, 0.3);
            box-shadow: 2px 2px 1px #333;
        }
    </style>
</head>
<body>
    <div id="control-panel">
        <button id="reloadBtn" value="reload">reload</button>
    </div>
    <div id="slick-images"></div>
    <div id="scripts">
        <script>
            var imageProperties = {
                height: 120,
                containerId: 'slick-images'
            };
            function log(functionName, paramList) {
                var paramString = paramList.map(function (item){
                    if(typeof item === typeof ''){
                        return item;
                    } else {
                        return JSON.stringify(item);
                    }
                }).join(' ');
                console.log(functionName, 'called with', paramString);
            }
            function addSlickImage(slickImage) {
                log('addSlickImage', [ 'slickImage', slickImage ]);
                var container = document.getElementById(imageProperties.containerId);
                container.appendChild(slickImage);
            }
            function createAnchor(url) {
                log('createAnchor', [ 'url', url ]);
                var anchor = document.createElement('a');
                anchor.href = url;
                return anchor;
            }
            function createImage(url, title) {
                log('createImage', [ 'url', url, 'title', title ]);
                var image = document.createElement('img');
                image.src = url;
                image.title = title;
                image.height = imageProperties.height;
                return image;
            }
            function addImageToAnchor(image, anchor) {
                log('addImageToAnchor', [ 'image', image, 'anchor', anchor ]);
                anchor.appendChild(image);
            }
            function makePhotoUrl(photo){
                log('makePhotoUrl',[ 'photo', photo ]);
                return "http://farm" + photo.farm + ".static.flickr.com/" +
                    photo.server + "/" + photo.id + "_" + photo.secret + "_" + "t.jpg";
            }
            function makeLinkUrl(photo){
                log('makeLinkUrl',[ 'photo', photo ]);
                return "http://www.flickr.com/photos/" + photo.owner + "/" + photo.id;
            }
            function jsonFlickrApi(res){
                log('jsonFlickrApi', [ 'res', res ]);
                window.res = res;

                for (var i = 0, len = res.photos.photo.length; i < len; i++) {
                    photo = res.photos.photo[i];
                    t_url = makePhotoUrl(photo);
                    p_url = makeLinkUrl(photo);
                    var anchor = createAnchor(p_url);
                    var image = createImage(t_url);
                    addImageToAnchor(image, anchor);
                    addSlickImage(anchor);
                }
            }
        </script>
        <script src="https://api.flickr.com/services/rest/?method=flickr.photos.getRecent&api_key=84bf9b29bce8db001d1e58dbec8a5770&per_page=10&page=1&format=json"></script>
    </div>
</body>
</html>
